---
layout: post
title:  "SQL 정리"
categories: SQL
---

# SQL 소개

## SQL이란?

* SQL (Structured Query Language)
* 데이터베이스에 접근하고 다루는데 사용된다
* ANSI (American National Standards Institute) 표준

## SQL로 할 수 있는 것

* EXECUTE Queries (데이터베이스 쿼리 실행)
* RETRIEVE Data (데이터 검색)
* INSERT Records (인서트)
* UPDATE Records (업데이트)
* DELETE Records (삭제)
* CREATE New Databases (데이터베이스 생성)
* CREATE New Tables (테이블 생성)
* CREATE Stored Procedures (저장 프로시져 생성)
* CREATE Views (뷰 생성)
* SET Permissions on Tables, Procedures, and Views (테이블, 프로시져, 뷰에 대한 권한 설정)

## 웹에서 SQL 사용

웹에 보여지는 데이터베이스를 빌드하기 위해 필요한 항목:

* RDBMS 데이터베이스 프로그램 (i.e. MS Access, SQL Server, MySQL)
* 서버 언어 (i.e. PHP, ASP)
* 원하는 데이터를 얻기 위한 SQL
* HTML/CSS

## RDBMS란?

* Relational Database Management System
* RDBMS는 SQL 그리고 모든 현대의 데이터베이스 프로그램들의 기초이다
* RDBMS에 저장되어 있는 데이터들은 테이블이라 불리우는 데이터베이스 객체에 저장된다
* 테이블은 관련 데이터들의 집합이며, 열과 행으로 이루어져있다

---

# SQL Syntax

## SQL 제어문

### SELECT 구문

```
SELECT column1, column2, ...
FROM table_name;
```

`table_name` 으로부터 `1행`과 `2행`을 선택해 가져온다

```
SELECT * FROM table_name;
```
`table_name` 으로부터 `모든` 데이터를 가져온다

### SELECT DISTINCT 구문

```
SELECT DISTINCT column1, column2, ...
FROM table_name;
```

`table_name` 으로부터 `1행`, `2행`을 가져오며 `중복`된 값은 다시 `가져오지 않는다`

```
SELECT COUNT(DISTINCT Country) FROM Customers;
```

`Customers` 테이블로부터 `중복된 밸류를 제외`한 나라의 `수`를 가져온다

```
SELECT Count(*) AS DistinctCountries
FROM (SELECT DISTINCT Country FROM Customers);
```

`Customers` 테이블로부터 `중복된 밸류를 제외`한 나라의 `수`를 가져온 `result-set`에서
`DistinctCountries` 라는 `result-set`이름으로 `수`를 가져온다

### WHERE 구문

```
SELECT column1, column2, ...
FROM table_name
WHERE condition:
```

`table_name`에서 `condition`이라는 조건에 충족하는 `1행`과 `2행`을 가져온다

```
SELECT * FROM Customers
WHERE Country='Mexico';
```
`Customers` 테이블에서 국적이 `Mexico`인 `모든 데이터`를 가져온다

```
SELECT * FROM Customers
WHERE CustomerID=1;
```

`텍스트 필드`는 `quote`으로 감싸줘야 하지만 `숫자 필드`는 감싸주지 않는다

**WHERE 절에 쓰이는 연산자**

연산자|설명
---|---
=|Equal
<>|Not Equal (!=)
>|Greater than
<|Less than
>=|Greater than or equal
<=|Less than or equal
BETWEEN|Between an inclusive range (경계값 포함)
LIKE|Serch for a pattern
IN|To specify multiple possible values for a column

### AND, OR, NOT 구문

```
SELECT * FROM Customers
WHERE Country='Germany' AND City='Berlin';
```

`Customers` 테이블에서 국적이 `Germany` 그리고 출신 도시가 `Berlin`인 데이터를 `모두` 리턴

```
SELECT * FROM Customers
WHERE City='Berlin' OR City='München';
```

`Customers` 테이블에서 출신도시가 `Berlin` 또는 `München`인 데이터를 `모두` 리턴

```
SELECT * FROM Customers
WHERE NOT Country='Germany';
```

`Customers` 테이블에서 국적이 `Germany`가 `아닌` 데이터를 모두 리턴

```
SELECT * FROM Customers
WHERE Country='Germany' AND (City='Berlin' OR City='München');
```

`Customers` 테이블에서 국적이 `Germany`이고 출신도시가 `Berlin` 또는 `München`인 데이터를 `모두` 리턴 

```
SELECT * FROM Customers
WHERE NOT Country='Germany' AND NOT Country='USA';
```

`Customers` 테이블에서 국적이 `Germany`와 `USA`가 `아닌` 데이터를 `모두` 리턴

### ORDER BY 구문 (ASC | DESC)

```
SELECT * FROM Customers
ORDER BY Country ASC, CustomerName DESC;
```

`Customer` 테이블에서 국적은 `오름차`, 이름은 `내림차`순으로 모든 데이터를 리턴

### INSERT INTO 구문

데이터베이스에 값을 입력할 때 행 이름을 모두 열거할 필요는 없지만 **행과 같은 순서**로 입력해야한다.

```
INSERT INTO Customers
VALUES ('Cardinal', 'Tom B. Erichsen', 'Skagen 21', 'Stavanger', '4006', 'Norway');
```

```
INSERT INTO Customers (CustomerName, City, Country)
VALUES ('Cardinal', 'Stavanger', 'Norway');
```

원하는 행만 지정해서 값을 입력할 수 있다.

### NULL 값

**IS NULL**

```
SELECT LastName, FirstName, Address FROM Persons
WHERE Address IS NULL;
```

`Persons` 테이블에서 주소값이 `Null`인 데이터 중 `LastName, FirstName, Address` 값을 리턴

**IS NOT NULL**
```
SELECT LastName, FirstName, Address FROM Persons
WHERE Address IS NOT NULL;
```

`Persons` 테이블에서 주소값이 `Null이 아닌` 데이터 중 `LastName, FirstName, Address` 값을 리턴

### UPDATE 구문

```
UPDATE Customers
SET ContactName = 'Alfred Schmidt', City = 'Frankfurt'
WHERE CustomerID = 1;
```

`Customers` 테이블에서 `CustomerID`가 1인 데이터의 `이름`과  `출신도시`를 업데이트

결과: `You have made changes to the database. Rows affected: 1`

```
UPDATE Customers
SET ContactName='Juan'
WHERE Country='Mexico';
```

`Customers` 테이블에서 `국적이 Mexico`인 데이터의 이름을 `Juan`으로 변경

**WHERE 문을 설정하지 않을 시**

```
UPDATE Customers
SET ContactName='Juan';
```

`Customers` 테이블의 모든 이름을 Juan으로 변경

### DELETE 구문

```
DELETE FROM Customers
WHERE CustomerName = 'Alfreds Futterkiste'
```

`Customers` 테이블에서 이름이 `Alfreds Fuitterkiste`인 데이터를 모두 지움

```
DELETE FROM Customers;
```
```
DELETE * FROM Customers;
```

위 두 구문 모두 `Customers` 테이블에 있는 모든 항목을 지움

### TOP, LIMIT, ROWNUM 절




